{% import "macros.html" as macros %}
<table>
    <thead>
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Status</th>
            <th>Started</th>
            <th>Duration</th>
            <th>Tokens</th>
            <th>Cost</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% if workflows %}
            {% for workflow in workflows[:50] %}
            <tr>
                <td class="monospace">
                    <a href="/workflows/{{ workflow.id }}" class="workflow-link">
                        {{ workflow.id[:8] }}...
                    </a>
                </td>
                <td>{{ workflow.workflow_name }}</td>
                <td>
                    {% set status_class = {
                        'running': 'badge-running',
                        'completed': 'badge-completed',
                        'failed': 'badge-failed',
                        'pending': 'badge-pending',
                        'cancelled': 'badge-cancelled'
                    }.get(workflow.status, 'badge-pending') %}
                    <span class="badge {{ status_class }}">{{ workflow.status }}</span>
                </td>
                <td>{{ workflow.started_at.strftime('%Y-%m-%d %H:%M:%S') if workflow.started_at else '-' }}</td>
                <td>
                    {% if workflow.duration_seconds %}
                        {% set minutes = (workflow.duration_seconds // 60) | int %}
                        {% set seconds = (workflow.duration_seconds % 60) | int %}
                        {% if minutes > 0 %}{{ minutes }}m {{ seconds }}s{% else %}{{ seconds }}s{% endif %}
                    {% elif workflow.status == 'running' %}
                        <span class="running-indicator"></span> Running
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td>{{ workflow.total_tokens or '-' }}</td>
                <td>${{ '%.4f'|format(workflow.total_cost_usd) if workflow.total_cost_usd else '0.0000' }}</td>
                <td>
                    <div class="action-buttons">
                        <a href="/workflows/{{ workflow.id }}" class="btn btn-sm btn-primary">View</a>
                        {% if workflow.status == 'running' %}
                        <button class="btn btn-sm btn-danger"
                                hx-post="/workflows/{{ workflow.id }}/cancel"
                                hx-confirm="Cancel this workflow?"
                                hx-swap="none">
                            Cancel
                        </button>
                        {% endif %}
                    </div>
                </td>
            </tr>
            {% endfor %}
        {% else %}
            <tr>
                <td colspan="8" class="empty-state">
                    <div class="empty-state-icon">No workflows found</div>
                    <p>No workflow runs match the current filters.</p>
                </td>
            </tr>
        {% endif %}
    </tbody>
</table>
